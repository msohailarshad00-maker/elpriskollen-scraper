name: Hourly Test - Split ZIPs (6 Jobs)

on:
  schedule:
    # Har ghante (00 minute UTC) â€” test ke liye
    - cron: '0 * * * *'
  workflow_dispatch:  # Manual run allowed

jobs:
  scrape-zip-group-0:
    runs-on: ubuntu-latest
    timeout-minutes: 25
    env:
      ZIP_GROUP: 0
    steps:
      - name: Checkout code
        uses: actions/checkout@v4

      - name: Set up Python
        uses: actions/setup-python@v5
        with:
          python-version: '3.11'

      - name: Install dependencies
        run: |
          pip install -r requirements.txt
          playwright install chromium

      - name: Write Google credentials
        run: echo '${{ secrets.GOOGLE_CREDENTIALS }}' > credentials.json

      - name: Run scraper + upload
        run: python scrape_elpriskollen.py

  scrape-zip-group-1:
    runs-on: ubuntu-latest
    timeout-minutes: 25
    env:
      ZIP_GROUP: 1
    steps:
      - uses: actions/checkout@v4
      - uses: actions/setup-python@v5
        with:
          python-version: '3.11'
      - run: pip install -r requirements.txt && playwright install chromium
      - run: echo '${{ secrets.GOOGLE_CREDENTIALS }}' > credentials.json
      - run: python scrape_elpriskollen.py

  scrape-zip-group-2:
    runs-on: ubuntu-latest
    timeout-minutes: 25
    env:
      ZIP_GROUP: 2
    steps:
      - uses: actions/checkout@v4
      - uses: actions/setup-python@v5
        with:
          python-version: '3.11'
      - run: pip install -r requirements.txt && playwright install chromium
      - run: echo '${{ secrets.GOOGLE_CREDENTIALS }}' > credentials.json
      - run: python scrape_elpriskollen.py

  scrape-zip-group-3:
    runs-on: ubuntu-latest
    timeout-minutes: 25
    env:
      ZIP_GROUP: 3
    steps:
      - uses: actions/checkout@v4
      - uses: actions/setup-python@v5
        with:
          python-version: '3.11'
      - run: pip install -r requirements.txt && playwright install chromium
      - run: echo '${{ secrets.GOOGLE_CREDENTIALS }}' > credentials.json
      - run: python scrape_elpriskollen.py

  scrape-zip-group-4:
    runs-on: ubuntu-latest
    timeout-minutes: 25
    env:
      ZIP_GROUP: 4
    steps:
      - uses: actions/checkout@v4
      - uses: actions/setup-python@v5
        with:
          python-version: '3.11'
      - run: pip install -r requirements.txt && playwright install chromium
      - run: echo '${{ secrets.GOOGLE_CREDENTIALS }}' > credentials.json
      - run: python scrape_elpriskollen.py

  scrape-zip-group-5:
    runs-on: ubuntu-latest
    timeout-minutes: 10   # Last group has only 1 ZIP
    env:
      ZIP_GROUP: 5
    steps:
      - uses: actions/checkout@v4
      - uses: actions/setup-python@v5
        with:
          python-version: '3.11'
      - run: pip install -r requirements.txt && playwright install chromium
      - run: echo '${{ secrets.GOOGLE_CREDENTIALS }}' > credentials.json
      - run: python scrape_elpriskollen.py
