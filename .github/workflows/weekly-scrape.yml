name: Hourly Test - Per ZIP (21 Jobs)

on:
  schedule:
    # Har ghante (00 minute UTC) â€” test ke liye
    - cron: '0 6 * * MON'   # Har Monday 6 AM UTC
  workflow_dispatch:  # Manual run allowed

jobs:
  scrape-zip:
    runs-on: ubuntu-latest
    timeout-minutes: 30
    strategy:
      matrix:
        zip_index: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20]
    env:
      ZIP_INDEX: ${{ matrix.zip_index }}
    steps:
      - name: Checkout code
        uses: actions/checkout@v4

      - name: Set up Python
        uses: actions/setup-python@v5
        with:
          python-version: '3.11'

      - name: Install dependencies
        run: |
          pip install -r requirements.txt
          playwright install chromium

      - name: Write Google credentials
        run: echo '${{ secrets.GOOGLE_CREDENTIALS }}' > credentials.json

      - name: Run scraper + upload
        run: python scrape_elpriskollen.py
